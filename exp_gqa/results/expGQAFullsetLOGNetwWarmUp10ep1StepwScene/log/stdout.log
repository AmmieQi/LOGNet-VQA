2020-08-23 10:45:10,184 INFO     gpu_id:3
2020-08-23 10:45:10,184 INFO     num_workers:4
2020-08-23 10:45:10,184 INFO     multi_gpus:False
2020-08-23 10:45:10,185 INFO     seed:666
2020-08-23 10:45:10,185 INFO     train:{'restore': False, 'lr': 0.0001, 'schedule_method': 'warm_up', 'gradual_warmup_steps': [0.0001, 0.0001, 0.0002, 0.0002], 'epoch_decay_start': 10, 'lr_decay_step': 1, 'lr_decay_rate': 0.25, 'batch_size': 64, 'max_epochs': 30, 'vision_dim': 2048, 'word_dim': 300, 'module_dim': 512, 'train_num': 500, 'net_length': 12, 'glove': True, 'control_input_unshared': True, 'weight_init': 'xavier_uniform'}
2020-08-23 10:45:10,185 INFO     val:{'flag': True, 'is_vis': False, 'write_preds': False, 'val_num': 500, 'batch_size': 64}
2020-08-23 10:45:10,185 INFO     test:{'test_num': 0, 'write_preds': True, 'batch_size': 64}
2020-08-23 10:45:10,185 INFO     dataset:{'name': 'gqa', 'annotation_file': '/AvaStore/DataSets/visual_qa/datasets/gqa/annotations/{}_balanced_questions.json', 'data_dir': '/home/lethao/workspace/VisualReasoning/ongoing/public_git_repos/lognet-vqa-private/exp_gqa/data', 'img_info': 'gqa_objects_merged_info.json', 'train_object_feature': 'gqa_objects.h5', 'train_spatial_feature': 'gqa_spatial.h5', 'val_object_feature': 'gqa_objects.h5', 'val_spatial_feature': 'gqa_spatial.h5', 'test_object_feature': 'gqa_objects.h5', 'test_spatial_feature': 'gqa_spatial.h5', 'vocab_json': 'gqa_vocab.json', 'train_question': 'gqa_train_questions.pt', 'val_question': 'gqa_val_questions.pt', 'test_question': 'gqa_test_questions.pt', 'save_dir': 'results/expGQAFullsetLOGNetwWarmUp10ep1StepwScene'}
2020-08-23 10:45:10,185 INFO     preprocess:{'answer_top': 4000, 'glove_pt': '/AvaStore/DataSets/visual_qa/datasets/glove/glove.840.300d.pkl'}
2020-08-23 10:45:10,185 INFO     exp_name:expGQAFullsetLOGNetwWarmUp10ep1StepwScene
2020-08-23 10:45:10,186 INFO     Create train_loader and val_loader.........
2020-08-23 10:45:11,272 INFO     number of train instances: 500
2020-08-23 10:45:11,589 INFO     number of val instances: 500
2020-08-23 10:45:11,589 INFO     Create model.........
2020-08-23 10:45:11,591 INFO     device: cuda
2020-08-23 10:45:11,591 INFO     net_len: 12
2020-08-23 10:45:28,080 INFO     num of params: 13973218
2020-08-23 10:45:28,081 INFO     LOGNet(
  (input_unit): InputUnit(
    (object_feat_proj): Linear(in_features=2048, out_features=512, bias=True)
    (spatial_feat_proj): Linear(in_features=7, out_features=512, bias=True)
    (object_spatial_cat): Linear(in_features=1024, out_features=512, bias=True)
    (encoder_embed): Embedding(2855, 300)
    (encoder): LSTM(300, 256, batch_first=True, bidirectional=True)
    (embedding_dropout): Dropout(p=0.15, inplace=False)
    (question_dropout): Dropout(p=0.18, inplace=False)
    (activation): ELU(alpha=1.0)
  )
  (output_unit): OutputUnit(
    (question_proj): Linear(in_features=512, out_features=512, bias=True)
    (activation): ELU(alpha=1.0)
    (classifier): Sequential(
      (0): Dropout(p=0.15, inplace=False)
      (1): Linear(in_features=1024, out_features=512, bias=True)
      (2): ELU(alpha=1.0)
      (3): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (4): Dropout(p=0.15, inplace=False)
      (5): Linear(in_features=512, out_features=1833, bias=True)
    )
  )
  (log_units): LOGUnits(
    (control): Controller(
      (attn_head_1): Linear(in_features=512, out_features=1, bias=True)
      (attn_head_2): Linear(in_features=512, out_features=1, bias=True)
      (control_input): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
        (1): Tanh()
      )
      (control_input_u): ModuleList(
        (0): Linear(in_features=512, out_features=512, bias=True)
        (1): Linear(in_features=512, out_features=512, bias=True)
        (2): Linear(in_features=512, out_features=512, bias=True)
        (3): Linear(in_features=512, out_features=512, bias=True)
        (4): Linear(in_features=512, out_features=512, bias=True)
        (5): Linear(in_features=512, out_features=512, bias=True)
        (6): Linear(in_features=512, out_features=512, bias=True)
        (7): Linear(in_features=512, out_features=512, bias=True)
        (8): Linear(in_features=512, out_features=512, bias=True)
        (9): Linear(in_features=512, out_features=512, bias=True)
        (10): Linear(in_features=512, out_features=512, bias=True)
        (11): Linear(in_features=512, out_features=512, bias=True)
      )
      (concat): Linear(in_features=1024, out_features=512, bias=True)
      (memory_gate): Sigmoid()
      (activation): ELU(alpha=1.0)
    )
    (adj_matrix): GraphConstructor(
      (concat): Linear(in_features=1024, out_features=512, bias=True)
      (dropout): Dropout(p=0.15, inplace=False)
      (kproj): Linear(in_features=512, out_features=512, bias=True)
      (mproj): Linear(in_features=512, out_features=512, bias=True)
      (activation): ELU(alpha=1.0)
      (rank_1_outer): Linear(in_features=512, out_features=1, bias=True)
    )
    (lang_binding): LanguageBinding(
      (concat): Linear(in_features=1024, out_features=512, bias=True)
      (dropout): Dropout(p=0.15, inplace=False)
      (kproj): Linear(in_features=512, out_features=512, bias=True)
      (mproj): Linear(in_features=512, out_features=512, bias=True)
      (activation): ELU(alpha=1.0)
      (words2nodes): WordsToSingleVisualNode(
        (words_embedding_proj): Linear(in_features=512, out_features=512, bias=True)
        (words_embedding_proj_2): Linear(in_features=512, out_features=1, bias=True)
        (words_embedding_proj_alpha): Linear(in_features=512, out_features=512, bias=False)
        (current_obj_feat_proj_alpha): Linear(in_features=512, out_features=512, bias=False)
        (attn_weight_u): ModuleList()
        (attn_weight): Linear(in_features=512, out_features=1, bias=False)
        (updated_obj_feat_proj): Linear(in_features=1024, out_features=512, bias=True)
        (weighted_sum_emb_proj): Linear(in_features=512, out_features=512, bias=True)
      )
    )
    (rep_refinement): RepRefinement(
      (attn): Linear(in_features=512, out_features=1, bias=True)
      (GCN): ResidualGCN(
        (gcn_block): GraphConvolution (512 -> 512)
        (linear): Linear(in_features=512, out_features=512, bias=False)
      )
    )
    (memory_update): MemoryUpdate(
      (linear): Linear(in_features=1024, out_features=512, bias=True)
    )
  )
)
2020-08-23 10:45:28,082 INFO     load glove vectors
2020-08-23 10:45:28,085 INFO     Start training........
2020-08-23 10:45:28,086 INFO     >>>>>> epoch [1m[32m0[0m <<<<<<
2020-08-23 10:46:03,965 INFO     Epoch = 0   avg_loss = 7.699    avg_acc = 0.002
2020-08-23 10:46:16,284 INFO     ~~~~~~ Valid Accuracy: 0.0000 ~~~~~~~
2020-08-23 10:46:16,285 INFO     >>>>>> epoch [1m[32m1[0m <<<<<<
2020-08-23 10:46:47,823 INFO     Epoch = 1   avg_loss = 7.123    avg_acc = 0.048
2020-08-23 10:47:09,428 INFO     ~~~~~~ Valid Accuracy: 0.0200 ~~~~~~~
2020-08-23 10:47:09,429 INFO     >>>>>> epoch [1m[32m2[0m <<<<<<
2020-08-23 10:47:41,192 INFO     Epoch = 2   avg_loss = 6.155    avg_acc = 0.212
2020-08-23 10:48:02,762 INFO     ~~~~~~ Valid Accuracy: 0.0420 ~~~~~~~
2020-08-23 10:48:02,763 INFO     >>>>>> epoch [1m[32m3[0m <<<<<<
2020-08-23 10:48:34,356 INFO     Epoch = 3   avg_loss = 4.893    avg_acc = 0.384
2020-08-23 10:48:55,791 INFO     ~~~~~~ Valid Accuracy: 0.0620 ~~~~~~~
2020-08-23 10:48:55,792 INFO     >>>>>> epoch [1m[32m4[0m <<<<<<
2020-08-23 10:49:27,781 INFO     Epoch = 4   avg_loss = 3.794    avg_acc = 0.526
2020-08-23 10:49:49,138 INFO     ~~~~~~ Valid Accuracy: 0.0840 ~~~~~~~
2020-08-23 10:49:49,138 INFO     >>>>>> epoch [1m[32m5[0m <<<<<<
2020-08-23 10:50:21,272 INFO     Epoch = 5   avg_loss = 3.040    avg_acc = 0.652
2020-08-23 10:50:42,776 INFO     ~~~~~~ Valid Accuracy: 0.1060 ~~~~~~~
2020-08-23 10:50:42,776 INFO     >>>>>> epoch [1m[32m6[0m <<<<<<
2020-08-23 10:51:14,773 INFO     Epoch = 6   avg_loss = 2.501    avg_acc = 0.720
2020-08-23 10:51:25,708 INFO     ~~~~~~ Valid Accuracy: 0.0620 ~~~~~~~
2020-08-23 10:51:25,708 INFO     >>>>>> epoch [1m[32m7[0m <<<<<<
2020-08-23 10:51:57,373 INFO     Epoch = 7   avg_loss = 1.967    avg_acc = 0.816
2020-08-23 10:52:08,306 INFO     ~~~~~~ Valid Accuracy: 0.0680 ~~~~~~~
2020-08-23 10:52:08,307 INFO     >>>>>> epoch [1m[32m8[0m <<<<<<
2020-08-23 10:52:40,169 INFO     Epoch = 8   avg_loss = 1.540    avg_acc = 0.914
2020-08-23 10:52:51,017 INFO     ~~~~~~ Valid Accuracy: 0.0600 ~~~~~~~
2020-08-23 10:52:51,018 INFO     >>>>>> epoch [1m[32m9[0m <<<<<<
2020-08-23 10:53:22,893 INFO     Epoch = 9   avg_loss = 1.202    avg_acc = 0.946
2020-08-23 10:53:33,855 INFO     ~~~~~~ Valid Accuracy: 0.0640 ~~~~~~~
2020-08-23 10:53:33,855 INFO     >>>>>> epoch [1m[32m10[0m <<<<<<
2020-08-23 10:54:05,770 INFO     Epoch = 10   avg_loss = 0.931    avg_acc = 0.972
2020-08-23 10:54:16,619 INFO     ~~~~~~ Valid Accuracy: 0.0640 ~~~~~~~
2020-08-23 10:54:16,620 INFO     >>>>>> epoch [1m[32m11[0m <<<<<<
